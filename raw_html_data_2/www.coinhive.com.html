<html class="no-js" lang="en"><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Troy Hunt: I Now Own the Coinhive Domain. Here's How I'm Fighting Cryptojacking and Doing Good Things with Content Security Policies.</title>
    <meta name="description" content="">

    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="https://www.troyhunt.com/assets/css/main.min.css?v=f6cb2300ac">
    <style type="text/css">@font-face {font-family:Vollkorn;font-style:normal;font-weight:400;src:url(/cf-fonts/s/vollkorn/5.0.18/greek/400/normal.woff2);unicode-range:U+0370-03FF;font-display:swap;}@font-face {font-family:Vollkorn;font-style:normal;font-weight:400;src:url(/cf-fonts/s/vollkorn/5.0.18/cyrillic/400/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Vollkorn;font-style:normal;font-weight:400;src:url(/cf-fonts/s/vollkorn/5.0.18/cyrillic-ext/400/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Vollkorn;font-style:normal;font-weight:400;src:url(/cf-fonts/s/vollkorn/5.0.18/latin/400/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Vollkorn;font-style:normal;font-weight:400;src:url(/cf-fonts/s/vollkorn/5.0.18/latin-ext/400/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Vollkorn;font-style:normal;font-weight:400;src:url(/cf-fonts/s/vollkorn/5.0.18/vietnamese/400/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Vollkorn;font-style:italic;font-weight:400;src:url(/cf-fonts/s/vollkorn/5.0.18/cyrillic/400/italic.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Vollkorn;font-style:italic;font-weight:400;src:url(/cf-fonts/s/vollkorn/5.0.18/greek/400/italic.woff2);unicode-range:U+0370-03FF;font-display:swap;}@font-face {font-family:Vollkorn;font-style:italic;font-weight:400;src:url(/cf-fonts/s/vollkorn/5.0.18/latin-ext/400/italic.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Vollkorn;font-style:italic;font-weight:400;src:url(/cf-fonts/s/vollkorn/5.0.18/vietnamese/400/italic.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Vollkorn;font-style:italic;font-weight:400;src:url(/cf-fonts/s/vollkorn/5.0.18/latin/400/italic.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Vollkorn;font-style:italic;font-weight:400;src:url(/cf-fonts/s/vollkorn/5.0.18/cyrillic-ext/400/italic.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Vollkorn;font-style:normal;font-weight:700;src:url(/cf-fonts/s/vollkorn/5.0.18/latin-ext/700/normal.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Vollkorn;font-style:normal;font-weight:700;src:url(/cf-fonts/s/vollkorn/5.0.18/cyrillic-ext/700/normal.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}@font-face {font-family:Vollkorn;font-style:normal;font-weight:700;src:url(/cf-fonts/s/vollkorn/5.0.18/vietnamese/700/normal.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Vollkorn;font-style:normal;font-weight:700;src:url(/cf-fonts/s/vollkorn/5.0.18/greek/700/normal.woff2);unicode-range:U+0370-03FF;font-display:swap;}@font-face {font-family:Vollkorn;font-style:normal;font-weight:700;src:url(/cf-fonts/s/vollkorn/5.0.18/cyrillic/700/normal.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Vollkorn;font-style:normal;font-weight:700;src:url(/cf-fonts/s/vollkorn/5.0.18/latin/700/normal.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Vollkorn;font-style:italic;font-weight:700;src:url(/cf-fonts/s/vollkorn/5.0.18/vietnamese/700/italic.woff2);unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+0300-0301,U+0303-0304,U+0308-0309,U+0323,U+0329,U+1EA0-1EF9,U+20AB;font-display:swap;}@font-face {font-family:Vollkorn;font-style:italic;font-weight:700;src:url(/cf-fonts/s/vollkorn/5.0.18/latin/700/italic.woff2);unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD;font-display:swap;}@font-face {font-family:Vollkorn;font-style:italic;font-weight:700;src:url(/cf-fonts/s/vollkorn/5.0.18/latin-ext/700/italic.woff2);unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF;font-display:swap;}@font-face {font-family:Vollkorn;font-style:italic;font-weight:700;src:url(/cf-fonts/s/vollkorn/5.0.18/greek/700/italic.woff2);unicode-range:U+0370-03FF;font-display:swap;}@font-face {font-family:Vollkorn;font-style:italic;font-weight:700;src:url(/cf-fonts/s/vollkorn/5.0.18/cyrillic/700/italic.woff2);unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116;font-display:swap;}@font-face {font-family:Vollkorn;font-style:italic;font-weight:700;src:url(/cf-fonts/s/vollkorn/5.0.18/cyrillic-ext/700/italic.woff2);unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F;font-display:swap;}</style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer">

    <link rel="icon" href="https://www.troyhunt.com/content/images/size/w256h256/2021/12/Troy-Hunt-LM-0059_square.png" type="image/png">
    <link rel="canonical" href="https://www.troyhunt.com/i-now-own-the-coinhive-domain-heres-how-im-fighting-cryptojacking-and-doing-good-things-with-content-security-policies/">
    <meta name="referrer" content="no-referrer-when-downgrade">
    
    <meta property="og:site_name" content="Troy Hunt">
    <meta property="og:type" content="article">
    <meta property="og:title" content="I Now Own the Coinhive Domain. Here's How I'm Fighting Cryptojacking and Doing Good Things with Content Security Policies.">
    <meta property="og:description" content="If you've landed on this page because you saw a strange message on a completely
different website then followed a link to here, drop a note to the site owner
and let them know what happened. If, on the other hand, you're on this page
because you're interested in reading">
    <meta property="og:url" content="https://www.troyhunt.com/i-now-own-the-coinhive-domain-heres-how-im-fighting-cryptojacking-and-doing-good-things-with-content-security-policies/">
    <meta property="og:image" content="https://www.troyhunt.com/content/images/2021/03/2021-03-29_17-11-30.png">
    <meta property="article:published_time" content="2021-03-31T19:18:36.000Z">
    <meta property="article:modified_time" content="2021-04-02T01:05:04.000Z">
    <meta property="article:tag" content="Security">
    <meta property="article:tag" content="CSP">
    <meta property="article:tag" content="Report URI">
    
    <meta property="article:publisher" content="https://www.facebook.com/troyahunt">
    <meta property="article:author" content="https://www.facebook.com/troyahunt">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="I Now Own the Coinhive Domain. Here's How I'm Fighting Cryptojacking and Doing Good Things with Content Security Policies.">
    <meta name="twitter:description" content="If you've landed on this page because you saw a strange message on a completely
different website then followed a link to here, drop a note to the site owner
and let them know what happened. If, on the other hand, you're on this page
because you're interested in reading">
    <meta name="twitter:url" content="https://www.troyhunt.com/i-now-own-the-coinhive-domain-heres-how-im-fighting-cryptojacking-and-doing-good-things-with-content-security-policies/">
    <meta name="twitter:image" content="https://www.troyhunt.com/content/images/2021/03/2021-03-29_17-11-30.png">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="Troy Hunt">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="Security, CSP, Report URI">
    <meta name="twitter:site" content="@troyhunt">
    <meta name="twitter:creator" content="@troyhunt">
    <meta property="og:image:width" content="1137">
    <meta property="og:image:height" content="808">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Troy Hunt",
        "url": "https://www.troyhunt.com/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://www.troyhunt.com/content/images/2016/04/Troy-Hunt-Profile-Photo.jpg",
            "width": 60,
            "height": 60
        }
    },
    "author": {
        "@type": "Person",
        "name": "Troy Hunt",
        "image": {
            "@type": "ImageObject",
            "url": "//www.gravatar.com/avatar/c5531bfb7d76cdaa370c7baf6053288d?s=250&d=mm&r=x",
            "width": 250,
            "height": 250
        },
        "url": "https://www.troyhunt.com/author/troyhunt/",
        "sameAs": [
            "https://www.troyhunt.com/",
            "https://www.facebook.com/troyahunt",
            "https://twitter.com/troyhunt"
        ]
    },
    "headline": "I Now Own the Coinhive Domain. Here&#x27;s How I&#x27;m Fighting Cryptojacking and Doing Good Things with Content Security Policies.",
    "url": "https://www.troyhunt.com/i-now-own-the-coinhive-domain-heres-how-im-fighting-cryptojacking-and-doing-good-things-with-content-security-policies/",
    "datePublished": "2021-03-31T19:18:36.000Z",
    "dateModified": "2021-04-02T01:05:04.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://www.troyhunt.com/content/images/2021/03/2021-03-29_17-11-30.png",
        "width": 1137,
        "height": 808
    },
    "keywords": "Security, CSP, Report URI",
    "description": "If you&#x27;ve landed on this page because you saw a strange message on a completely\ndifferent website then followed a link to here, drop a note to the site owner\nand let them know what happened. If, on the other hand, you&#x27;re on this page\nbecause you&#x27;re interested in reading about the illicit use of cryptomining on\ncompromised websites and how through fortuitous circumstances, I now own\ncoinhive.com and am doing something useful with it, read on.\n\nYou know how people don&#x27;t like ads? Yeah, me either (",
    "mainEntityOfPage": "https://www.troyhunt.com/i-now-own-the-coinhive-domain-heres-how-im-fighting-cryptojacking-and-doing-good-things-with-content-security-policies/"
}
    </script>

    <meta name="generator" content="Ghost 5.117">
    <link rel="alternate" type="application/rss+xml" title="Troy Hunt" href="https://www.troyhunt.com/rss/">
    <!--<script defer="" src="https://cdn.jsdelivr.net/ghost/portal@~2.50/umd/portal.min.js" data-i18n="true" data-ghost="https://www.troyhunt.com/" data-key="5e03cd80efbea6ff26214a466b" data-api="https://troyhunt.ghost.io/ghost/api/content/" data-locale="en" crossorigin="anonymous" type="8863b39a809806125b4fa229-text/javascript"></script>--><style id="gh-members-styles">.gh-post-upgrade-cta-content,
.gh-post-upgrade-cta {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    text-align: center;
    width: 100%;
    color: #ffffff;
    font-size: 16px;
}

.gh-post-upgrade-cta-content {
    border-radius: 8px;
    padding: 40px 4vw;
}

.gh-post-upgrade-cta h2 {
    color: #ffffff;
    font-size: 28px;
    letter-spacing: -0.2px;
    margin: 0;
    padding: 0;
}

.gh-post-upgrade-cta p {
    margin: 20px 0 0;
    padding: 0;
}

.gh-post-upgrade-cta small {
    font-size: 16px;
    letter-spacing: -0.2px;
}

.gh-post-upgrade-cta a {
    color: #ffffff;
    cursor: pointer;
    font-weight: 500;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a:hover {
    color: #ffffff;
    opacity: 0.8;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a.gh-btn {
    display: block;
    background: #ffffff;
    text-decoration: none;
    margin: 28px 0 0;
    padding: 8px 18px;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 600;
}

.gh-post-upgrade-cta a.gh-btn:hover {
    opacity: 0.92;
}</style>
    <!--<script defer="" src="https://cdn.jsdelivr.net/ghost/sodo-search@~1.5/umd/sodo-search.min.js" data-key="5e03cd80efbea6ff26214a466b" data-styles="https://cdn.jsdelivr.net/ghost/sodo-search@~1.5/umd/main.css" data-sodo-search="https://troyhunt.ghost.io/" data-locale="en" crossorigin="anonymous" type="8863b39a809806125b4fa229-text/javascript"></script>-->
    
    <link href="https://www.troyhunt.com/webmentions/receive/" rel="webmention">
    <!--<script defer="" src="/public/cards.min.js?v=f6cb2300ac" type="8863b39a809806125b4fa229-text/javascript"></script>-->
    <link rel="stylesheet" type="text/css" href="/public/cards.min.css?v=f6cb2300ac">
    <!--<script defer="" src="/public/member-attribution.min.js?v=f6cb2300ac" type="8863b39a809806125b4fa229-text/javascript"></script>--><style>:root {--ghost-accent-color: #15171A;}</style>
    <link rel="preload" as="script" href="https://platform.twitter.com/widgets.js"><link rel="preload" as="script" href="https://www.googletagmanager.com/gtag/js?id=G-B895JNTH7Z"><link rel="preload" as="script" href="/public/member-attribution.min.js?v=f6cb2300ac"><link rel="preload" as="script" href="/public/cards.min.js?v=f6cb2300ac"><link rel="preload" as="script" href="https://cdn.jsdelivr.net/ghost/sodo-search@~1.5/umd/sodo-search.min.js" crossorigin="anonymous"><link rel="preload" as="script" href="https://cdn.jsdelivr.net/ghost/portal@~2.50/umd/portal.min.js" crossorigin="anonymous"></head><body class="post-template tag-security tag-csp tag-report-uri"><a rel="me" href="https://infosec.exchange/@troyhunt">Mastodon</a>
    <!--<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-B895JNTH7Z" type="text/javascript"></script>-->
    <!--<script type="text/javascript">function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-B895JNTH7Z");</script>-->
  

  

    <div id="container">
        



<div class="header_block container">
    <div class="header">
        <button class="header_navMenu_button i-menu" id="open-button"></button>
            <div class="header_navMenu_wrap">
        <nav role="navigation">
            <ul class="header_navMenu">
            <li class="navMenu_list" role="presentation">
                <a class="navMenu_link" href="https://www.troyhunt.com/">Home</a>
            </li>
            <li class="navMenu_list" role="presentation">
                <a class="navMenu_link" href="https://www.troyhunt.com/workshops/">Workshops</a>
            </li>
            <li class="navMenu_list" role="presentation">
                <a class="navMenu_link" href="https://www.troyhunt.com/speaking/">Speaking</a>
            </li>
            <li class="navMenu_list" role="presentation">
                <a class="navMenu_link" href="https://www.troyhunt.com/media/">Media</a>
            </li>
            <li class="navMenu_list" role="presentation">
                <a class="navMenu_link" href="https://www.troyhunt.com/about/">About</a>
            </li>
            <li class="navMenu_list" role="presentation">
                <a class="navMenu_link" href="https://www.troyhunt.com/contact/">Contact</a>
            </li>
            <li class="navMenu_list" role="presentation">
                <a class="navMenu_link" href="https://www.troyhunt.com/sponsorship/">Sponsor</a>
            </li>
            </ul>
        </nav>
    </div>
        <div class="header_socialIcons light">
            <ul>
    <li class="socialIcons_link">
        <a class="fa-brands fa-x-twitter" href="https://twitter.com/troyhunt"></a>
    </li>
    <li class="socialIcons_link">
        <a class="fa-brands fa-facebook-f" href="https://www.facebook.com/troyahunt"></a>
    </li>
    <li class="socialIcons_link">
        <a class="fa-brands fa-linkedin-in" href="https://www.linkedin.com/in/troyhunt"></a>
    </li>
    <li class="socialIcons_link">
        <a class="fa-brands fa-youtube" href="https://www.youtube.com/user/troyhuntdotcom"></a>
    </li>
    <li class="socialIcons_link">
        <a class="fa fa-rss" href="https://feeds.feedburner.com/TroyHunt"></a>
    </li>
</ul>        </div>
    </div>
</div>
<div class="sponsor_bar content">
    <p id="sponsor_message"><strong>Sponsored by:</strong> <i class="fa fa-circle-o-notch fa-spin fa-3x fa-fw"></i></p>
</div>


<div class="post_header container" style="background-image: url(/content/images/2021/03/2021-03-29_17-11-30.png)">
  <div class="hover"></div>
</div>



<div class="main-wrapper">
<div class="content-wrapper">

<div class="article-open container no-cover">
    <div class="hover"></div>
    <article class="article-open_item wrap">
        <header class="post_head">
            <h1>I Now Own the Coinhive Domain. Here's How I'm Fighting Cryptojacking and Doing Good Things with Content Security Policies.</h1>
            <div class="post_socialIcons">
                <ul>
                    <li class="socialIcons_link">
                        <a class="fa-brands fa-x-twitter article-open_window" href="https://twitter.com/share?url=https://www.troyhunt.com/i-now-own-the-coinhive-domain-heres-how-im-fighting-cryptojacking-and-doing-good-things-with-content-security-policies/&amp;text=Troy%20Hunt%3A%20I%20Now%20Own%20the%20Coinhive%20Domain.%20Here's%20How%20I'm%20Fighting%20Cryptojacking%20and%20Doing%20Good%20Things%20with%20Content%20Security%20Policies."></a>
                    </li>
                    <li class="socialIcons_link">
                        <a class="fa-brands fa-facebook-f article-open_window" href="https://www.facebook.com/sharer/sharer.php?u=https://www.troyhunt.com/i-now-own-the-coinhive-domain-heres-how-im-fighting-cryptojacking-and-doing-good-things-with-content-security-policies/"></a>
                    </li>
                    <li class="socialIcons_link linkedin">
                        <a class="fa-brands fa-linkedin-in article-open_window" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.troyhunt.com/i-now-own-the-coinhive-domain-heres-how-im-fighting-cryptojacking-and-doing-good-things-with-content-security-policies/"></a>
                    </li>
                    <li class="socialIcons_link reddit article-open_window">
                        <a class="fa-brands fa-reddit-alien" href="https://reddit.com/submit?url=https://www.troyhunt.com/i-now-own-the-coinhive-domain-heres-how-im-fighting-cryptojacking-and-doing-good-things-with-content-security-policies/&amp;title=Troy%20Hunt%3A%20I%20Now%20Own%20the%20Coinhive%20Domain.%20Here's%20How%20I'm%20Fighting%20Cryptojacking%20and%20Doing%20Good%20Things%20with%20Content%20Security%20Policies."></a>
                    </li>
                    <li class="socialIcons_link">
                        <a class="fa fa-envelope" href="mailto:?subject=Troy%20Hunt%3A%20I%20Now%20Own%20the%20Coinhive%20Domain.%20Here's%20How%20I'm%20Fighting%20Cryptojacking%20and%20Doing%20Good%20Things%20with%20Content%20Security%20Policies.&amp;body=https://www.troyhunt.com/i-now-own-the-coinhive-domain-heres-how-im-fighting-cryptojacking-and-doing-good-things-with-content-security-policies/"></a>
                    </li>
                </ul>
            </div>
            <span class="post_info">01 April 2021</span>
        </header>
    </article>
</div>

<main class="article-open_content container">
    <article class="wrap">
        <section class="article_text post">
            <p>If you've landed on this page because you saw a strange message on a completely different website then followed a link to here, drop a note to the site owner and let them know what happened. If, on the other hand, you're on this page because you're interested in reading about the illicit use of cryptomining on compromised websites and how through fortuitous circumstances, I now own coinhive.com and am doing something useful with it, read on.</p><p>You know how people don't like ads? Yeah, me either (at least not the spammy tracky ones that invade both your privacy and your bandwidth), but I also like free content on the web and therein lies the rub; how do content producers monetise their work if they can't put ads on pages? Well naturally, you "Monetize Your Business with Your Users' CPU Power" which was <a href="https://web.archive.org/web/20190429040938/https://coinhive.com/">Coinhives's</a> modus operandi. That's a link to the last snapshotted version on archive.org because if you go to <a href="http://coinhive.com/?ref=troyhunt.com">coinhive.com</a> today, you'll see nothing. The website is dead. However, it's now owned by me and it's just sitting there doing pretty much nothing other than serving a little bit of JavaScript. I'll come back to that shortly, let's return to the business model of Coinhive:</p><p>So, instead of serving ads you put a JavaScript based cryptominer on your victi... sorry - <em>visitors </em>- browsers then whilst they're sitting there reading your content, you're harvesting Monero coin on their machine. They're paying for the CPU cycles to put money into your pocket - ingenious! But there were two massive problems with this and the first one is probably obvious: it's a sleazy business model that (usually unknowingly) exploits people's electricity bills for the personal gain of the site operator. It might only be exploiting them a little bit (how much power can an in-browser JS cryptominer really draw?), but it still feels super shady. The second problem is that due to the anonymous nature of cryptocurrency, every hacker and their dog wanted to put Coinhive on any sites they were able to run their own arbitrary JavaScript on.</p><p>I'll give you a perfect example of that last point: in Feb 2018 I wrote about <a href="https://www.troyhunt.com/the-javascript-supply-chain-paradox-sri-csp-and-trust-in-third-party-libraries/">The JavaScript Supply Chain Paradox: SRI, CSP and Trust in Third Party Libraries</a> wherein someone had compromised a JS file on the Browsealoud service and injected the Coinhive script into it. In that blog post I included the code Scott Helme had de-obfuscated which showed a very simple bit of JavaScript, really just the inclusion of a .js file from coinhive.com and the setting of a 32-byte key. And that's all an attacker needed to do - include the Coinhive JS, add their key and if they wished, toggle a few configurations. That's it, job done, instant crypto!</p><p><a href="https://www.zdnet.com/article/coinhive-cryptojacking-service-to-shut-down-in-march-2019/?ref=troyhunt.com">And then Coinhive was gone</a>. (Also - "the company was making in an estimated $250,000 per month" - crikey!) The site disappeared and the domain stopped resolving. Every site that had Coinhive running on it, either by the design of the site owner or at the whim of a cryptojacker, stopped mining Monero. However, it was still making requests to the domain but without the name resolving anywhere, the only signs of Coinhive being gone were errors in the browser's developer tools.</p><p>In May 2020, I obtained both the primary coinhive.com domain and a few other ancillary ones related to the service, for example cnhv.co which was used for their link shortener (which also caused browsers to mine Monero). I'm not sure how much the person who made these available to me wants to share so the only thing I'll say for now is that they were provided to me for free to do something useful with. 2020 got kinda busy and it was only very recently that I was finally able to come back to Coinhive. I stood up a website and just logged requests. Every request resulted in a 404, but every request also went into a standard Azure App Service log. And that's where things got a lot more interesting.</p><p>Firstly, the high-level stats and as I was routing through Cloudflare, it was super easy to look at the volume of requests first:</p><figure class="kg-card kg-image-card"><img src="https://www.troyhunt.com/content/images/2021/03/image-60.png" class="kg-image" alt="" loading="lazy" width="984" height="488" srcset="https://www.troyhunt.com/content/images/size/w600/2021/03/image-60.png 600w, https://www.troyhunt.com/content/images/2021/03/image-60.png 984w" sizes="(min-width: 720px) 720px"></figure><p>That's a <em>substantial </em>number of requests; peaking at 3.63M in a day for a service that doesn't even exist anymore. But the number that really impressed me (if "impressed" is the right word here...) was the number of unique visitors per day:</p><figure class="kg-card kg-image-card"><img src="https://www.troyhunt.com/content/images/2021/03/image-61.png" class="kg-image" alt="" loading="lazy" width="981" height="496" srcset="https://www.troyhunt.com/content/images/size/w600/2021/03/image-61.png 600w, https://www.troyhunt.com/content/images/2021/03/image-61.png 981w" sizes="(min-width: 720px) 720px"></figure><p>Daaaamn! More than 2 years after Coinhive was gone and the miner is still embedded in enough places to be serving more than 100k unique visitors per day. Whoa. I wonder where they're all coming from?</p><figure class="kg-card kg-image-card"><img src="https://www.troyhunt.com/content/images/2021/03/image-62.png" class="kg-image" alt="" loading="lazy" width="1034" height="833" srcset="https://www.troyhunt.com/content/images/size/w600/2021/03/image-62.png 600w, https://www.troyhunt.com/content/images/size/w1000/2021/03/image-62.png 1000w, https://www.troyhunt.com/content/images/2021/03/image-62.png 1034w" sizes="(min-width: 720px) 720px"></figure><p>Just for context, Have I Been Pwned (which sees about 200k visitors per day) has a geographical distribution as follows:</p><figure class="kg-card kg-image-card"><img src="https://www.troyhunt.com/content/images/2021/03/image-42.png" class="kg-image" alt="" loading="lazy" width="1024" height="247" srcset="https://www.troyhunt.com/content/images/size/w600/2021/03/image-42.png 600w, https://www.troyhunt.com/content/images/size/w1000/2021/03/image-42.png 1000w, https://www.troyhunt.com/content/images/2021/03/image-42.png 1024w" sizes="(min-width: 720px) 720px"></figure><p>I'm loath to draw stereotypical conclusions about the association of hackers to Russia and China, but it's a bit inescapable here. Later on, when I analysed the various URLs that were injecting Coinhive, there was (anecdotally) a strong presence of Russian and Chinese websites.</p><p>Moving on, here's a typical log entry captured once I stood up the empty website:</p><!--kg-card-begin: html--><pre><code>#Fields: date time s-sitename cs-method cs-uri-stem cs-uri-query s-port cs-username c-ip cs(User-Agent) cs(Cookie) cs(Referer) cs-host sc-status sc-substatus sc-win32-status sc-bytes cs-bytes time-taken

2021-03-27 02:59:32 COINHIVE GET /lib/coinhive.min.js X-ARR-LOG-ID=061e55e4-6380-4e88-a7f6-d4ea53071b71 443 - 172.69.166.8 Mozilla/5.0+(Linux;+Android+8.0.0;+ATU-LX3)+AppleWebKit/537.36+(KHTML,+like+Gecko)+Chrome/88.0.4324.181+Mobile+Safari/537.36 ARRAffinitySameSite=0e2a05ba3fa8945356c52a5d6a03ef6078571b96359db7d489b1580040a9fdec https://lookedon.com/ coinhive.com 404 0 2 470 1424 15</code></pre><!--kg-card-end: html--><p>The JS file being requested is how Coinhive was usually embedded in a site. The IP is Cloudflare's (remember, they're a reverse proxy so it's their IP the website receives) and the response code is 404 as there was no resource to return. The referrer is the interesting one because this tells us where the script was requested from, in this case a website at <a href="https://lookedon.com/?ref=troyhunt.com">lookedon.com</a>. A quick glance at that site at the time of writing and yeah, that's a cryptominer in the HTML source:</p><figure class="kg-card kg-image-card"><img src="https://www.troyhunt.com/content/images/2021/03/image-39.png" class="kg-image" alt="" loading="lazy" width="1028" height="118" srcset="https://www.troyhunt.com/content/images/size/w600/2021/03/image-39.png 600w, https://www.troyhunt.com/content/images/size/w1000/2021/03/image-39.png 1000w, https://www.troyhunt.com/content/images/2021/03/image-39.png 1028w" sizes="(min-width: 720px) 720px"></figure><p>Before we go any further delving into the ins and outs of cryptominers, I <em>strongly </em>recommend watching this video by Hugo Bijmans and Christian Doerr from the Delft University of Technology presenting at the USENIX Security Symposium a couple of years ago. It's only 21 minutes long and it gets straight to the point:</p><!--kg-card-begin: html--><iframe width="100%" height="480" src="https://www.youtube.com/embed/EhmekYj1pIY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen=""></iframe><!--kg-card-end: html--><p>There's also a much more comprehensive paper from Hugo and colleagues titled <a href="https://www.usenix.org/system/files/sec19-bijmans.pdf?ref=troyhunt.com">Inadvertently Making Cyber Criminals Rich: A Comprehensive Study of Cryptojacking Campaigns at Internet Scale</a>. If you want to go much deeper, have a good read through this. (Incidentally, I've been in touch with Hugo and we're discussing how to best use the data I'm logging for both research and defensive purposes.)</p><p>I pulled down several days of logs beginning 2021-03-27 and imported them into a DB where I could analyse things more easily (8.9M rows in total). I looked firstly at the content that was being requested (all subsequent figures exclude the cnhv.co link shortener domain unless otherwise stated):</p><figure class="kg-card kg-image-card"><img src="https://www.troyhunt.com/content/images/2021/03/image-55.png" class="kg-image" alt="" loading="lazy" width="323" height="209"></figure><p>The prevalence of the JavaScript miners is no surprise, and the Delft guys talk about the role of the WebAssembly (.wasm) in their paper. There were references to WASM in <a href="https://web.archive.org/web/20190430083127/https://coinhive.com/lib/coinhive.min.js">the original Coinhive script</a>, but of course nobody has been loading that for quite some time so I can only assume it's being embedded by other means. The logs don't have a referrer on any of the WASM entries either so it's not clear where the requests are originating from:</p><!--kg-card-begin: html--><pre><code>2021-03-27 02:59:42 COINHIVE GET /lib/cryptonight.wasm X-ARR-LOG-ID=3aebf86b-116e-4ce6-a8a5-2c3d9911a2c4 443 - 162.158.167.112 Mozilla/5.0+(Windows+NT+10.0;+Win64;+x64)+AppleWebKit/537.36+(KHTML,+like+Gecko)+apollohobo/1.0.0+Chrome/58.0.3029.110+Electron/1.7.9+Safari/537.36 - - coinhive.com 404 0 2 470 1205 15</code></pre><!--kg-card-end: html--><p>I put this to Hugo and he made the following comment:</p><blockquote>When the coinhive.min.js script was downloaded from the original Coinhive server, it analyzed the target system, determined the number of CPU threads available and afterwards downloaded that WASM file to be distributed amongst a number of WebWorkers (often the same number of threads available). That WASM file is where the actual mining is taking place, as WebAssembly can be executed almost as fast as native machine code. The name of that particular WASM file changed a few times in the past, which explains why there is a variation of Wasm files requested. Some websites serve the coinhive.min.js script from their own server (to prevent detection), but the WebWorkers will still request the WASM file from the original Coinhive domain, as the JS script has barely changed.</blockquote><p>Next up is the referrer, but due to there being many different paths on the same site serving the miner, I grouped by host and reported on that:</p><figure class="kg-card kg-image-card"><img src="https://www.troyhunt.com/content/images/2021/03/image-56.png" class="kg-image" alt="" loading="lazy" width="259" height="208"></figure><p>I found more than 41k unique domains in the referrer header. That's many tens of thousands of websites still attempting to embed Coinhive. Taking a look at <a href="http://webtruyenonline.com/?ref=troyhunt.com">webtruyenonline.com</a> (the root of the site featured heavily in the referrers), the site is in Vietnamese but upon visiting it, I couldn't find any sign whatsoever of Coinhive. Not in the page source, not requested from a downstream dependency and not on other deeper links in the referrers either. Looking closer at the log entries, a pattern emerged with the user agents, so I filtered those out and grouped them:</p><figure class="kg-card kg-image-card"><img src="https://www.troyhunt.com/content/images/2021/03/image-57.png" class="kg-image" alt="" loading="lazy" width="373" height="208"></figure><p>They're all mobile devices. I changed the UA string I was sending to the first one above and reissued the request, but there was still no Coinhive in the HTML response. Is it tailoring the response based on the location of the requesting IP? I connected NordVPN to Vietnam and tried again. Nothing. I even proxied my own iPhone through Fiddler then VPN'd to Vietnam and still nothing. That's a totally standard UA for Safari on iOS 14.4.1 too, so no clues there as to what circumstances are causing these requests. Hugo also had some thoughts on this one:</p><blockquote>During our follow-up research on cryptojacking, we discovered that 1.4M MikroTik routers were serving cryptojacking scripts as they were routing Web traffic, geographically focussed on Brazil and Indonesia. It could be that a Vietnamese MikroTik router is still infected and somehow manages to inject the script into that particular (popular) website.</blockquote><p>I'll take this opportunity to make a quick call back to <a href="https://www.troyhunt.com/heres-why-your-static-website-needs-https/">Here's Why Your Static Website Needs HTTPS</a>. Securing the transport layer isn't just about protecting sensitive information, it's also about protecting the integrity of the content and assuming Hugo is right here, this is a beautiful demonstration of the necessity of HTTPS <em>everywhere</em>. More on this in their paper titled <a href="https://www.cyber-threat-intelligence.com/publications/CCS2019-router.pdf?ref=troyhunt.com">Just the Tip of the Iceberg: Internet-Scale Exploitation of Routers for Cryptojacking</a>.</p><p>The next host name at <a href="http://aahora.org/?ref=troyhunt.com">aahora.org</a>, however, was a totally different story and sure enough, there's Coinhive:</p><figure class="kg-card kg-image-card"><img src="https://www.troyhunt.com/content/images/2021/03/image-46.png" class="kg-image" alt="" loading="lazy" width="687" height="150" srcset="https://www.troyhunt.com/content/images/size/w600/2021/03/image-46.png 600w, https://www.troyhunt.com/content/images/2021/03/image-46.png 687w"></figure><p>I don't intend to keep going through the top hits, the point is that the presence of requests in the logs doesn't always map cleanly to the presence of Coinhive on the site in the referrer. I can think of a variety of reasons for this but suffice to say there were still <em>a heap</em> of sites attempting to embed a cryptominer in the browser.</p><p>There was just one more thing I was interested in - what can we tell about concerted cryptojacking campaigns based on the data? I mean how many of these log entries were from sites running the same Coinhive key which would indicate the same actor behind each site? So, I wrangled up a little crawler script and started scraping each unique site looking for the presence of Coinhive. It's a basic one (it merely looks for a Coinhive key in the HTML source so misses keys embedded in another JS file or an iframe), but it's sufficient for my requirements here. I crawled the first 375k URIs based on the most prevalent in the logs, pulled back the keys and recorded the number of unique URIs and host names they appeared on. I found over 3k unique keys, here's the top 10:</p><figure class="kg-card kg-image-card"><img src="https://www.troyhunt.com/content/images/2021/03/image-64.png" class="kg-image" alt="" loading="lazy" width="871" height="262" srcset="https://www.troyhunt.com/content/images/size/w600/2021/03/image-64.png 600w, https://www.troyhunt.com/content/images/2021/03/image-64.png 871w" sizes="(min-width: 720px) 720px"></figure><p>Doing a bit of Googling for the keys, I found 2 interesting things and the first one relates to the second key ("FgW..."):</p><!--kg-card-begin: html--><blockquote class="twitter-tweet" data-conversation="none"><p lang="und" dir="ltr">Eight new CoinHive keys on infected MikroTik-devices; 1/2 <br><br>FgWWtJfuvPmrfwjOfgc9Vo55EyvrMBLh:45+ infections <br>dqorRUUFnc3SFuNIwYCka4QnICAngtNk:35+<br>BOvlp33stLBwyDob7HH4FmQg35jx32iv:35+<br>9pFICAsxNfFPjTILDGhD5D3jqkAqDRND:35+<br>cc <a href="https://twitter.com/bad_packets?ref_src=twsrc%5Etfw&amp;ref=troyhunt.com">@bad_packets</a></p>â€” Kira 2.0 (@VriesHd) <a href="https://twitter.com/VriesHd/status/1040634067018895360?ref_src=twsrc%5Etfw&amp;ref=troyhunt.com">September 14, 2018</a></blockquote> <!--<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8" type="text/javascript"></script>--><!--kg-card-end: html--><p>Well, that supports Hugo's earlier thesis. As prevalent as that key may be having appeared on 103 unique hosts, it could just be a single infected router. Further supporting the MikroTik theory was that every single URL was served unencrypted over HTTP:</p><figure class="kg-card kg-image-card"><img src="https://www.troyhunt.com/content/images/2021/03/image-65.png" class="kg-image" alt="" loading="lazy" width="318" height="237"></figure><p>In this particular case there was a heavy bias towards "sahara" domains. These relate to <a href="https://en.wikipedia.org/wiki/Subrata_Roy?ref=troyhunt.com">Subarta Roy</a>, a name I only knew after recently watching the Netflix series <a href="https://www.netflix.com/au/title/80990073?ref=troyhunt.com">Bad Boy Billionaires</a>, of which he is apparently one. Is there someone within the corrupt billionaires org running an infected router that's cryptojacking all their non-secure requests? I suspect that's just one of many curious mysteries within the data set.</p><p>That third key - "w9W..." - has a Google hit that links directly back to the Dutch research paper:</p><figure class="kg-card kg-image-card"><img src="https://www.troyhunt.com/content/images/2021/03/image-50.png" class="kg-image" alt="" loading="lazy" width="1395" height="422" srcset="https://www.troyhunt.com/content/images/size/w600/2021/03/image-50.png 600w, https://www.troyhunt.com/content/images/size/w1000/2021/03/image-50.png 1000w, https://www.troyhunt.com/content/images/2021/03/image-50.png 1395w" sizes="(min-width: 720px) 720px"></figure><p>It's hard to draw any conclusion other than that there remains a large number of compromised websites out there hosting Coinhive even now that Coinhive is dead. They're no longer mining crypto, of course, however these sites are still embedding JavaScript on them from a domain <em>I</em> control so...</p><figure class="kg-card kg-image-card kg-width-full"><img src="https://www.troyhunt.com/content/images/2021/03/image-52.png" class="kg-image" alt="" loading="lazy" width="1137" height="808" srcset="https://www.troyhunt.com/content/images/size/w600/2021/03/image-52.png 600w, https://www.troyhunt.com/content/images/size/w1000/2021/03/image-52.png 1000w, https://www.troyhunt.com/content/images/2021/03/image-52.png 1137w"></figure><!--kg-card-begin: markdown--><p><img src="https://www.troyhunt.com/content/images/2021/03/2021-03-29_17-11-30.png" alt="" loading="lazy"></p>
<!--kg-card-end: markdown--><figure class="kg-card kg-image-card kg-width-full"><img src="https://www.troyhunt.com/content/images/2021/03/image-54.png" class="kg-image" alt="" loading="lazy" width="1137" height="808" srcset="https://www.troyhunt.com/content/images/size/w600/2021/03/image-54.png 600w, https://www.troyhunt.com/content/images/size/w1000/2021/03/image-54.png 1000w, https://www.troyhunt.com/content/images/2021/03/image-54.png 1137w"></figure><p>The modal is embedded directly from script served by the site I stood up. The link goes through to this blog post and the message can be easily dismissed by folks who just want to browse the site. I thought carefully about this approach; did I really want to modify other people's websites? I want site owners to know there's a high likelihood they've been compromised, problem is how do you do that otherwise when we're talking about tens of thousands of sites? I've done enough disclosures over enough years to know that even doing this <em>once</em> is painful, but if I was to write just a little bit of JavaScript instead...</p><p>Oh - and while we're here let's just let that sink in for a moment: I can now run whatever JavaScript I want on a huge number of websites. So, what could I do with JavaScript? I could change where forms post to, add a key logger, modify the DOM, make external requests, redirect to a malicious file and all sorts of other very nasty things. That's the power you hand over when you embed someone else's JS in your own site and that's <em>precisely</em> why we have subresource integrity. <a href="https://www.troyhunt.com/the-javascript-supply-chain-paradox-sri-csp-and-trust-in-third-party-libraries/">I linked earlier to my post on SRI as it related to the Browsealoud incident</a> and this situation right here is as good a demonstration as ever as to why verifying the integrity of external assets is so important.</p><p>So, what's the fix? Well, it depends, and to answer that we need to go back to the preso from Delft uni guys, in particular this slide:</p><figure class="kg-card kg-image-card"><img src="https://www.troyhunt.com/content/images/2021/03/image-34.png" class="kg-image" alt="" loading="lazy" width="1833" height="1028" srcset="https://www.troyhunt.com/content/images/size/w600/2021/03/image-34.png 600w, https://www.troyhunt.com/content/images/size/w1000/2021/03/image-34.png 1000w, https://www.troyhunt.com/content/images/size/w1600/2021/03/image-34.png 1600w, https://www.troyhunt.com/content/images/2021/03/image-34.png 1833w" sizes="(min-width: 720px) 720px"></figure><p>If the miner is owner-initiated then firstly, shame on them, and secondly, just remove it. If it was their conscious decision to embed the miner in the first place, they can then remove it of their own free volition. But much more prevalent than this is malicious activity, in fact it accounts for the vast majority of instances once you consider both third-party software compromises and compromises of the primary website itself:</p><figure class="kg-card kg-image-card"><img src="https://www.troyhunt.com/content/images/2021/03/image-35.png" class="kg-image" alt="" loading="lazy" width="1829" height="1024" srcset="https://www.troyhunt.com/content/images/size/w600/2021/03/image-35.png 600w, https://www.troyhunt.com/content/images/size/w1000/2021/03/image-35.png 1000w, https://www.troyhunt.com/content/images/size/w1600/2021/03/image-35.png 1600w, https://www.troyhunt.com/content/images/2021/03/image-35.png 1829w" sizes="(min-width: 720px) 720px"></figure><p>The answer here is twofold, and the first part is obviously to either remove the compromised code or third-party library then, of course, fix the underlying vulnerability (i.e. change weak admin credentials that allowed it to be placed on the site in the first place). But we also have the technology to ensure the crypto code could <em>never</em> have run on the site in the first place, and that brings me back to CSPs.</p><p>Let's take one of the most commonly occurring websites in my logs, <a href="https://lookedon.com/?ref=troyhunt.com">lookedon.com</a>. This service enables you to "find interesting pictures" and like most modern web sites, it embeds all sorts of content types from different places by design. For example, there's a bunch of the following:</p><ol><li>Images loaded from pbs.twimg.com</li><li>Script loaded from connect.facebook.net</li><li>Fonts from fonts.gstatic.com</li><li>Other content from its own domain, for example style sheets and more images</li></ol><p>There are other content types loaded from other locations but for the sake of simplicity, let's just work with this list for now. Using a content security policy, I can define the content types and locations the browser is allowed to make requests to and anything that deviates from that known good state is blocked. Here's what a policy for the 4 points above would look like:</p><!--kg-card-begin: html--><pre><code>default-src 'none'; img-src 'self' pbs.twimg.com; script-src-elem connect.facebook.net; font-src: fonts.gstatic.com; style-src 'self';</code></pre><!--kg-card-end: html--><p>The CSP is then returned as a response header for any pages on the website. I can emulate this behaviour by injecting it into the site with <a href="https://www.telerik.com/blogs/understanding-fiddlerscript?ref=troyhunt.com">FiddlerScript</a> then inspecting the response in Chrome's dev tools:</p><figure class="kg-card kg-image-card"><img src="https://www.troyhunt.com/content/images/2021/03/image-37.png" class="kg-image" alt="" loading="lazy" width="1121" height="157" srcset="https://www.troyhunt.com/content/images/size/w600/2021/03/image-37.png 600w, https://www.troyhunt.com/content/images/size/w1000/2021/03/image-37.png 1000w, https://www.troyhunt.com/content/images/2021/03/image-37.png 1121w" sizes="(min-width: 720px) 720px"></figure><p>Nothing is allowed to load from anywhere (default-src 'none') then only the explicitly defined content types are allowed to load from the explicitly defined locations. As such, here's what happens when the browser is asked to embed the Coinhive script:</p><figure class="kg-card kg-image-card"><img src="https://www.troyhunt.com/content/images/2021/03/image-36.png" class="kg-image" alt="" loading="lazy" width="1415" height="137" srcset="https://www.troyhunt.com/content/images/size/w600/2021/03/image-36.png 600w, https://www.troyhunt.com/content/images/size/w1000/2021/03/image-36.png 1000w, https://www.troyhunt.com/content/images/2021/03/image-36.png 1415w" sizes="(min-width: 720px) 720px"></figure><p>It's rejected. There's only one place this website can embed scripts from and that's connect.facebook.net. What we're doing here is creating an "allow list" of all the things that we as the website developer know to be <em>good</em>, and then allowing the browser to block everything else. Someone drops a crypto miner on your site via any of the methods mentioned above and wammo! Nothing happens ðŸ˜Š</p><p>But wait, there's more: wouldn't it be great to know when this happens? In the Browsealoud situation from earlier, I'd love to know as soon as a third-party service or library I depend on starts doing something unexpected. And I'd <em>especially </em>like to know if someone drops malicious script onto my own site, so let's tweak the CSP a bit:</p><!--kg-card-begin: html--><pre><code>default-src 'none'; img-src 'self' pbs.twimg.com; script-src-elem connect.facebook.net; font-src: fonts.gstatic.com; style-src 'self'; report-uri https://troyhunt.report-uri.com/r/d/csp/enforce;</code></pre><!--kg-card-end: html--><p>All I've added here is the report-uri directive right at the end and this brings me to... <a href="https://report-uri.com/?ref=troyhunt.com">Report URI</a>!</p><!--kg-card-begin: html--><p><img src="https://www.troyhunt.com/content/images/2017/11/Logo-2.svg" alt="Report URI Logo"></p><!--kg-card-end: html--><p>Full disclosure: <a href="https://report-uri.com/?ref=troyhunt.com">Report URI</a> is a service Scott and I run together and there's a bunch of both free and commercial stuff. But having said that, what I'm about to delve into is equally applicable whether you use our service or stand up your own reporting endpoint; this is about the browser technology rather than a product pitch. (And yes, we know <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/report-uri?ref=troyhunt.com">report-uri is deprecated</a> but it's supported extensively unlike <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/report-to?ref=troyhunt.com">report-to</a> which is still patchy, but we own the domain name anyway ðŸ™‚)</p><p>When you use the report-uri feature in a content security policy, violations in the policy can be automatically sent to an endpoint of your choosing. In the example above I have my own subdomain on report-uri.com and I've configured that host as the location my visitors' browsers should send any violation reports. Subsequently, when we test this on lookedon.com we see the following report sent by the browser:</p><figure class="kg-card kg-image-card"><img src="https://www.troyhunt.com/content/images/2021/03/image-38.png" class="kg-image" alt="" loading="lazy" width="1785" height="632" srcset="https://www.troyhunt.com/content/images/size/w600/2021/03/image-38.png 600w, https://www.troyhunt.com/content/images/size/w1000/2021/03/image-38.png 1000w, https://www.troyhunt.com/content/images/size/w1600/2021/03/image-38.png 1600w, https://www.troyhunt.com/content/images/2021/03/image-38.png 1785w" sizes="(min-width: 720px) 720px"></figure><p>Imagine that you as the person responsible for this site received the violation report above; it tells you that the document-uri (the root of lookedon.com) tried to embed the blocked-uri (the Coinhive JS file) and that it violated the effective-directive that is "script-src-elem". In other words, someone is trying to put Coinhive on your site, but the browser has blocked it and you've just had this report personally delivered to you. Neat! Put a CSP on your site and report violations, it's one of the best defences going for a whole bunch of typical web attacks.</p><p>Last thing: <a href="https://github.com/troyhunt/Coinhive?ref=troyhunt.com">the code that now runs on coinhive.com is available on GitHub</a> and I'm happy to take pull requests. I'd love it if folks could work out a way to serve something useful in response to the WASM requests and I'm certainly open to any suggestions re cleaning up that JS or doing anything else useful to help both individuals and site owners alike. And no, don't tell me to just put my own cryptominer in there ðŸ™‚</p><p><strong>Edit:</strong> Less than half a day after publishing this, I received a pull request with <a href="https://github.com/troyhunt/Coinhive/pull/3?ref=troyhunt.com">a full WASM implementation</a> that will show the same message to any browser directly calling a .wasm file. Massive thanks to Chad Baxter for doing this!</p>

            <section class="article-open_tag">
                <a class="tag" href="/tag/security/">Security</a>
                <a class="tag" href="/tag/csp/">CSP</a>
                <a class="tag" href="/tag/report-uri/">Report URI</a>
            </section>
        </section>
        <footer class="post">
            <section class="article-open_shere">
                <a class="article-open_shere-twitter article-open_window" href="https://twitter.com/share?text=Troy%20Hunt%3A%20I%20Now%20Own%20the%20Coinhive%20Domain.%20Here's%20How%20I'm%20Fighting%20Cryptojacking%20and%20Doing%20Good%20Things%20with%20Content%20Security%20Policies.&amp;url=https://www.troyhunt.com/i-now-own-the-coinhive-domain-heres-how-im-fighting-cryptojacking-and-doing-good-things-with-content-security-policies/"><i class="fa-brands fa-x-twitter"></i> Tweet</a>
                <a class="article-open_shere-facebook article-open_window" href="https://www.facebook.com/sharer/sharer.php?u=https://www.troyhunt.com/i-now-own-the-coinhive-domain-heres-how-im-fighting-cryptojacking-and-doing-good-things-with-content-security-policies/"><i class="fa-brands fa-facebook-f"></i> Post</a>
                <a class="article-open_shere-linkedin article-open_window" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://www.troyhunt.com/i-now-own-the-coinhive-domain-heres-how-im-fighting-cryptojacking-and-doing-good-things-with-content-security-policies/"><i class="fa-brands fa-linkedin-in"></i> Update</a>
                <a class="article-open_shere-email" href="mailto:?subject=Troy%20Hunt%3A%20I%20Now%20Own%20the%20Coinhive%20Domain.%20Here's%20How%20I'm%20Fighting%20Cryptojacking%20and%20Doing%20Good%20Things%20with%20Content%20Security%20Policies.&amp;body=https://www.troyhunt.com/i-now-own-the-coinhive-domain-heres-how-im-fighting-cryptojacking-and-doing-good-things-with-content-security-policies/"><i class="fa fa-envelope"></i> Email</a>
                <a class="article-open_shere-feed" href="https://feeds.feedburner.com/TroyHunt"><i class="fa fa-rss"></i> RSS</a>
            </section>
            <section class="article-open_author">
                <figure class="article-open_author_image">
                <div class="img" style="background-image: url(//www.gravatar.com/avatar/c5531bfb7d76cdaa370c7baf6053288d?s=250&amp;d=mm&amp;r=x)"><span class="hidden">Troy Hunt's Picture</span></div>
                </figure>
                <div class="article-open_author_bio">
                    <h5 itemprop="author" itemscope="" itemtype="http://schema.org/Person">Troy Hunt</h5>
                    <p>Hi, I'm Troy Hunt, I write this blog, create courses for Pluralsight and am a Microsoft Regional Director and MVP who travels the world speaking at events and training technology professionals <a href="/about" class="article_link-more fa fa-long-arrow-right"></a></p>
                </div>
            </section>
                <div id="disqus_thread"></div>
                <div id="disqus_post_url" data="https://www.troyhunt.com/i-now-own-the-coinhive-domain-heres-how-im-fighting-cryptojacking-and-doing-good-things-with-content-security-policies/"></div>
                <div id="disqus_post_identifier" data="ghost-605f9d0e3a580664b3c53054"></div>
                <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

        </footer>
    </article>
</main>

</div>
<div class="content-sidebar">

  <div class="widget sidebar-featured">
    <h4 class="sidebar-featured-header">Troy Hunt</h4>
    <p>Hi, I'm Troy Hunt, I write this blog, run "Have I Been Pwned" and am a Microsoft Regional Director and MVP who travels the world speaking at events and training technology professionals <a href="/about" class="article_link-more fa fa-long-arrow-right"></a></p>
  </div>

  <div class="widget sidebar-featured">
    <h4 class="sidebar-featured-header">Upcoming Events</h4>
    <p>I often run <a href="/workshops">private workshops</a> around these, here's upcoming events I'll be at:</p>
    <div id="events_list"><i class="fa fa-circle-o-notch fa-spin fa-3x fa-fw"></i></div>
  </div>

  <div class="widget sidebar-featured">
    <h4 class="sidebar-featured-header">Must Read</h4>
    <ul>
      <li><a href="/data-breach-disclosure-101-how-to-succeed-after-youve-failed/">Data breach disclosure 101: How to succeed after you've failed</a></li>
      <li><a href="/data-from-connected-cloudpets-teddy-bears-leaked-and-ransomed-exposing-kids-voice-messages/">Data from connected CloudPets teddy bears leaked and ransomed, exposing kids' voice messages</a></li>
      <li><a href="/heres-how-i-verify-data-breaches/">Here's how I verify data breaches</a></li>
      <li><a href="/when-nation-is-hacked-understanding/">When a nation is hacked: Understanding the ginormous Philippines data breach</a></li>
      <li><a href="/how-i-optimised-my-life-to-make-my-job/">How I optimised my life to make my job redundant</a></li>
    </ul>
  </div>

  <div class="widget sidebar-featured">
    <a href="https://pluralsight.pxf.io/c/1196446/424552/7490?u=https%3A%2F%2Fwww.pluralsight.com%2F" class="pluralsight-logo">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 344.3 74.3" xml:space="preserve"><g><g><g><linearGradient id="SVGID_1_" gradientUnits="userSpaceOnUse" x1="37.3433" y1="2.431" x2="37.3433" y2="73.614"><stop offset="0" style="stop-color:#F05A28"></stop><stop offset="1" style="stop-color:#EB008B"></stop></linearGradient><circle fill="url(#SVGID_1_)" cx="37.3" cy="37.3" r="36"></circle></g><g><path fill="#FFFFFF" d="M31.2,24l23.1,13.3L31.2,50.6L31.2,24 M28.1,18.6l0,37.4l32.4-18.7L28.1,18.6L28.1,18.6z"></path><path fill="#FFFFFF" d="M23.7,28l16,9.3l-16,9.3V28 M20.6,22.7v29.2L46,37.3L20.6,22.7L20.6,22.7z"></path></g></g><g><g><path fill="#231F20" d="M100.3,37.7c2.6,0,4.2-1.4,4.2-3.5v-0.1c0-2.3-1.6-3.5-4.2-3.5h-4v7H100.3z M92.9,27.5h7.7c4.5,0,7.4,2.6,7.4,6.5v0.1c0,4.4-3.5,6.7-7.8,6.7h-3.9V47h-3.4V27.5z"></path></g><polygon fill="#231F20" points="116.5,27.5 119.9,27.5 119.9,43.9 130.2,43.9 130.2,47 116.5,47 "></polygon><g><path fill="#231F20" d="M137.9,38.8V27.5h3.4v11.1c0,3.6,1.9,5.6,4.9,5.6c3,0,4.9-1.8,4.9-5.4V27.5h3.4v11.1c0,5.8-3.3,8.8-8.4,8.8C141.1,47.4,137.9,44.4,137.9,38.8"></path><path fill="#231F20" d="M172.7,37.2c2.5,0,4-1.3,4-3.3v-0.1c0-2.1-1.5-3.2-4-3.2h-5v6.6H172.7z M164.3,27.5h8.7c2.5,0,4.4,0.7,5.6,2c1,1.1,1.6,2.5,1.6,4.2v0.1c0,3.2-1.9,5.1-4.7,5.9l5.3,7.4h-4l-4.8-6.8h-4.3V47h-3.4V27.5z"></path></g><path fill="#231F20" d="M201.2,39.3l-3.4-7.8l-3.3,7.8H201.2z M196.3,27.4h3.2l8.6,19.6h-3.6l-2-4.7h-9.2l-2,4.7h-3.5L196.3,27.4z"></path><polygon fill="#231F20" points="216.4,27.5 219.9,27.5 219.9,43.9 230.1,43.9 230.1,47 216.4,47 "></polygon><g><path fill="#231F20" d="M237.4,44.2l2.1-2.5c1.9,1.6,3.7,2.5,6.2,2.5c2.1,0,3.5-1,3.5-2.5v-0.1c0-1.4-0.8-2.1-4.4-3c-4.2-1-6.5-2.2-6.5-5.8v-0.1c0-3.3,2.8-5.7,6.7-5.7c2.8,0,5.1,0.9,7.1,2.5l-1.8,2.6c-1.8-1.3-3.5-2-5.3-2c-2,0-3.2,1-3.2,2.3v0.1c0,1.5,0.9,2.2,4.6,3.1c4.1,1,6.3,2.5,6.3,5.7v0.1c0,3.7-2.9,5.8-7,5.8C242.5,47.3,239.7,46.3,237.4,44.2"></path></g><rect x="261.7" y="27.5" fill="#231F20" width="3.4" height="19.5"></rect><g><path fill="#231F20" d="M274.5,37.4L274.5,37.4c0-5.5,4.2-10.1,10.1-10.1c3.4,0,5.5,0.9,7.5,2.6l-2.2,2.6c-1.5-1.3-3-2.1-5.5-2.1c-3.6,0-6.3,3.2-6.3,6.9v0.1c0,4,2.6,7,6.6,7c1.8,0,3.5-0.6,4.7-1.5v-3.7h-5v-3h8.3v8.2c-1.9,1.6-4.7,3-8.1,3C278.5,47.4,274.5,43,274.5,37.4"></path></g><polygon fill="#231F20" points="302.2,27.5 305.6,27.5 305.6,35.7 315,35.7 315,27.5 318.4,27.5 318.4,47 315,47 315,38.8 305.6,38.8 305.6,47 302.2,47 "></polygon><polygon fill="#231F20" points="327,27.5 327,30.7 333.2,30.7 333.2,47 336.6,47 336.6,30.7 342.8,30.7 342.8,27.5 "></polygon></g></g></svg>
    </a>
    <p>Don't have Pluralsight already? <a href="https://pluralsight.pxf.io/c/1196446/424552/7490?u=https%3A%2F%2Fbilling.pluralsight.com%2Findividual%2Fcheckout">How about a 10 day free trial?</a> That'll get you access to thousands of courses amongst which are dozens of my own including:</p>
    <ol>
      <li><a href="https://pluralsight.pxf.io/c/1196446/424552/7490?u=https%3A%2F%2Fwww.pluralsight.com%2Fcourses%2Fowasp-top10-aspdotnet-application-security-risks">OWASP Top 10 Web Application Security Risks for ASP.NET</a></li>
      <li><a href="https://pluralsight.pxf.io/c/1196446/424552/7490?u=https%3A%2F%2Fwww.pluralsight.com%2Fcourses%2Fhttps-every-developer-must-know">What Every Developer Must Know About HTTPS</a></li>
      <li><a href="https://pluralsight.pxf.io/c/1196446/424552/7490?u=https%3A%2F%2Fwww.pluralsight.com%2Fcourses%2Fhack-yourself-first">Hack Yourself First: How to go on the Cyber-Offense</a></li>
      <li><a href="https://pluralsight.pxf.io/c/1196446/424552/7490?u=https%3A%2F%2Fwww.pluralsight.com%2Fcourses%2Finformation-security-big-picture">The Information Security Big Picture</a></li>
      <li><a href="https://pluralsight.pxf.io/c/1196446/424552/7490?u=https%3A%2F%2Fwww.pluralsight.com%2Fcourses%2Fethical-hacking-social-engineering">Ethical Hacking: Social Engineering</a></li>
      <li><a href="https://pluralsight.pxf.io/c/1196446/424552/7490?u=https%3A%2F%2Fwww.pluralsight.com%2Fcourses%2Fmodernizing-websites-microsoft-azure">Modernizing Your Websites with Azure Platform as a Service</a></li>
      <li><a href="https://pluralsight.pxf.io/c/1196446/424552/7490?u=https%3A%2F%2Fwww.pluralsight.com%2Fcourses%2Fbrowser-security-headers">Introduction to Browser Security Headers</a></li>
      <li><a href="https://pluralsight.pxf.io/c/1196446/424552/7490?u=https%3A%2F%2Fwww.pluralsight.com%2Fcourses%2Fethical-hacking-sql-injection">Ethical Hacking: SQL Injection</a></li>
      <li><a href="https://pluralsight.pxf.io/c/1196446/424552/7490?u=https%3A%2F%2Fwww.pluralsight.com%2Fcourses%2Fweb-security-owasp-top10-big-picture">Web Security and the OWASP Top 10: The Big Picture</a></li>
      <li><a href="https://pluralsight.pxf.io/c/1196446/424552/7490?u=https%3A%2F%2Fwww.pluralsight.com%2Fcourses%2Fethical-hacking-web-applications">Ethical Hacking: Hacking Web Applications</a></li>
    </ol>
  </div>

</div>
</div>

<aside class="article_readNext">
    <a class="article_readNext_story col-2" href="/weekly-update-237/">
        <section class="post">
            <h4>Weekly Update 237</h4>
        </section>
    </a>
    <a class="article_readNext_story prev col-2" href="/weekly-update-236/">
        <section class="post">
            <h4>Weekly Update 236</h4>
        </section>
    </a>
</aside>
        
    </div>

    <footer id="footer">
    
<div class="footer_block" id="floating_subscribe">
      <div class="footer">
        <a href="#subscribe" id="subscribe_link">Subscribe <i class="fa fa-envelope-o" aria-hidden="true"></i></a>
        <div class="subscribe_close">
            <a href="#" id="close_floating_subscribe"><i class="fa fa-times" aria-hidden="true"></i></a>
        </div>
    </div>
</div>

<div class="footer_subscription_block container">
  <div class="footer_subscription wrap">
    <div class="footer_subscription_formGroup">
      <a id="subscribe"></a>
      <h4>Subscribe Now!</h4>
      <form name="subscribe_form" id="subscribe_form">
        <div id="new_subscription">
          <div id="subscribe_unsuccessful"></div>
          <p>
            Send new blog posts:<br>
            </p><div class="radio_button_group"><input type="radio" name="email_cadence" id="Daily" value="Daily" checked=""> <label for="Daily">daily</label></div>
            <div class="radio_button_group"><input type="radio" name="email_cadence" id="Weekly" value="Weekly"> <label for="Weekly">weekly</label></div>
          <p></p>
          <input type="email" value="" name="email_to_subscribe" id="email_to_subscribe" placeholder="email address" required="">
          <input type="submit" value="go!" id="submit_subscribe">
        </div>
        <div id="confirm_captcha"><p>Hey, just quickly confirm you're not a robot:</p></div>
        <div id="subscribe_loading"><p><i class="fa fa-cog fa-spin" aria-hidden="true"></i> Submitting...</p></div>
        <div id="subscribe_successful"><p>Got it! Check your email, click the confirmation link I just sent you and we're done.</p></div>
      </form>
    </div>
  </div>
</div>
    <div class="footer_informations_block container">
    <div class="footer_informations wrap">
        <div class="footer_information-1 col-3">
            <h6>Copyright 2025, Troy Hunt</h6>
            <p>This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>. In other words, share generously but provide attribution.</p>
        </div>
        <div class="footer_information-2 col-3">
            <h6>Disclaimer</h6>
            <p>Opinions expressed here are my own and may not reflect those of others. Unless I'm quoting someone, they're just my own views.</p>
        </div>
        <div class="footer_information-3 col-3">
            <h6>Published with Ghost</h6>
            <p>This site runs entirely on <a href="https://ghost.org/">Ghost</a> and is made possible thanks to their kind support. Read more about <a href="https://www.troyhunt.com/its-a-new-blog/">why I chose to use Ghost</a>.</p>
        </div>
    </div>
</div>

    <div class="footer_info_block container">
        <div class="footer_info wrap">
            <div class="footer_socialIcons">
                <ul>
    <li class="socialIcons_link">
        <a class="fa-brands fa-x-twitter" href="https://twitter.com/troyhunt"></a>
    </li>
    <li class="socialIcons_link">
        <a class="fa-brands fa-facebook-f" href="https://www.facebook.com/troyahunt"></a>
    </li>
    <li class="socialIcons_link">
        <a class="fa-brands fa-linkedin-in" href="https://www.linkedin.com/in/troyhunt"></a>
    </li>
    <li class="socialIcons_link">
        <a class="fa-brands fa-youtube" href="https://www.youtube.com/user/troyhuntdotcom"></a>
    </li>
    <li class="socialIcons_link">
        <a class="fa fa-rss" href="https://feeds.feedburner.com/TroyHunt"></a>
    </li>
</ul>            </div>
        </div>
    </div>
    </footer>

    

    <!--<script type="text/javascript">
      !function(s){"use strict";function e(s){return new RegExp("(^|\\s+)"+s+"(\\s+|$)")}function n(s,e){var n=a(s,e)?c:t;n(s,e)}var a,t,c;"classList"in document.documentElement?(a=function(s,e){return s.classList.contains(e)},t=function(s,e){s.classList.add(e)},c=function(s,e){s.classList.remove(e)}):(a=function(s,n){return e(n).test(s.className)},t=function(s,e){a(s,e)||(s.className=s.className+" "+e)},c=function(s,n){s.className=s.className.replace(e(n)," ")});var i={hasClass:a,addClass:t,removeClass:c,toggleClass:n,has:a,add:t,remove:c,toggle:n};"function"==typeof define&&define.amd?define(i):s.classie=i}(window);
      !function(){function e(){n()}function n(){i.addEventListener("click",t),d&&d.addEventListener("click",t),c.addEventListener("click",function(e){var n=e.target;a&&n!==i&&t()})}function t(){a?classie.remove(o,"show-menu"):classie.add(o,"show-menu"),a=!a}var o=document.body,c=document.querySelector("#container"),i=document.getElementById("open-button"),d=document.getElementById("close-button"),a=!1;e();for(var r=function(e){e.preventDefault(),window.open(this.href,"social-share","width=580,height=296")},s=document.getElementsByClassName("article-open_window"),u=0;u<s.length;u++)s[u].addEventListener("click",r,!1)}();
      function showUnsponsored(){document.getElementById("sponsor_message").innerHTML='<a href="/sponsorship"><strong>Sponsored by:</strong> I\'m unsponsored today, click to learn more</a>'}function showNoEvents(){document.getElementById("events_list").innerHTML="<p>No upcoming events were found</p>"}function showSponsor(e){null===e?showUnsponsored():document.getElementById("sponsor_message").innerHTML='<a href="'+e.campaignUrl+'" target="_blank" rel="noopener"><strong>Sponsored by:</strong> '+e.message+' <i class="fa fa-external-link" aria-hidden="true"></i></a>'}function showEvents(e){if(0===e.length)showNoEvents();else{var n="<ol>";e.forEach(function(e){n+=null!==e.url?'<li><a href="'+e.url+'">'+e.name+": "+e.date+", "+e.location+"</a></li>":"<li>"+e.name+": "+e.date+", "+e.location+"</li>"}),n+="</ol>",document.getElementById("events_list").innerHTML=n}}var xmlhttp=new XMLHttpRequest,url="https://bloghelpers.troyhunt.com/api/BlogData";xmlhttp.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var e=JSON.parse(this.responseText);null===e||void 0===e?(showUnsponsored(),showNoEvents()):(showSponsor(e.currentSponsor),showEvents(e.events))}else 4===this.readyState&&200!==this.status&&(showUnsponsored(),showNoEvents())},xmlhttp.open("GET",url,!0),xmlhttp.send();
      var disqus_config=function(){this.page.url=document.getElementById("disqus_post_url").getAttribute("data"),this.page.identifier=document.getElementById("disqus_post_identifier").getAttribute("data")};!function(){if(null!=document.getElementById("disqus_post_identifier")&&null!=document.getElementById("disqus_post_url")){var t=document,e=t.createElement("script");e.src="//troyhunt.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}}();
      function reCaptchaSolved(){document.getElementById("subscribe_loading").style.display="block",document.getElementById("confirm_captcha").style.display="none";for(var e,t=encodeURIComponent(document.getElementById("email_to_subscribe").value),n=encodeURIComponent(window.location),c=document.getElementsByName("email_cadence"),s=0,l=c.length;s<l;s++)if(c[s].checked){e=c[s].value;break}var a=document.getElementById("g-recaptcha-response").value,i="Email="+t+"&EmailCadence="+e+"&SourceUrl="+n+"&g-recaptcha-response="+a,o=new XMLHttpRequest;o.open("POST","https://bloghelpers.troyhunt.com/api/subscribe",!0),o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.onload=function(){if(document.getElementById("subscribe_loading").style.display="none",200===this.status)document.getElementById("subscribe_successful").style.display="block";else{var e=JSON.parse(this.responseText),t="FakeOrInvalid"===e?"Uh oh, apparently that's a fake or invalid email, sorry!":"Uh oh, that didn't work.Try submitting it again.";document.getElementById("subscribe_unsuccessful").innerHTML="<p>"+t+"</p >",document.getElementById("subscribe_unsuccessful").style.display="block",document.getElementById("new_subscription").style.display="block"}},o.send(i)}function closeFloatingSubscribe(){floating_subscribe.style.display="none",document.cookie="closeFloatingSubscribe=true; expires=1 Jan 2030 00:00:00 UTC; path=/"}document.getElementById("subscribe_form").addEventListener("submit",function(e){if(e.preventDefault(),document.getElementById("new_subscription").style.display="none",window.___grecaptcha_cfg)grecaptcha.reset();else{var t=document.createElement("script");t.setAttribute("src","https://www.google.com/recaptcha/api.js"),document.head.appendChild(t);var n=document.createElement("div");n.setAttribute("class","g-recaptcha"),n.setAttribute("data-sitekey","6LdqYhoUAAAAADieTdwsCSDl0-zIpp6Ga-JzatIZ"),n.setAttribute("data-callback","reCaptchaSolved"),document.getElementById("confirm_captcha").appendChild(n)}document.getElementById("confirm_captcha").style.display="inline-block"});var floating_subscribe=document.getElementById("floating_subscribe");document.cookie.indexOf("closeFloatingSubscribe")===-1&&(floating_subscribe.style.display="block");var closeElement=document.getElementById("close_floating_subscribe");closeElement.addEventListener("click",function(e){closeFloatingSubscribe(),e.preventDefault()},!1);var subscribeElement=document.getElementById("subscribe_link");subscribeElement.addEventListener("click",function(){closeFloatingSubscribe()},!1);
    </script>-->
  <script defer="" src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon="{&quot;rayId&quot;:&quot;931b331ecf2e8106&quot;,&quot;version&quot;:&quot;2025.4.0-1-g37f21b1&quot;,&quot;serverTiming&quot;:{&quot;name&quot;:{&quot;cfExtPri&quot;:true,&quot;cfL4&quot;:true,&quot;cfSpeedBrain&quot;:true,&quot;cfCacheStatus&quot;:true}},&quot;token&quot;:&quot;f5f5d408f2b9449f93595afd84a7f822&quot;,&quot;b&quot;:1}" crossorigin="anonymous"></script>


</body></html>